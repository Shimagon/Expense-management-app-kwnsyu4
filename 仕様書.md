# 支出記録アプリ（Expense Tracker）仕様書

## 1. 概要

支出記録アプリは、日々の支出を記録・管理し、カテゴリ別に集計・可視化するWebアプリケーションです。ブラウザのlocalStorageを使用してデータを永続化し、シンプルかつ直感的なUIで誰でも簡単に家計管理ができることを目指します。

## 2. 目的

### 2.1 主な目的
- 日々の支出を簡単に記録できる仕組みの提供
- 支出をカテゴリ別に分類し、お金の使い道を可視化
- 無駄な支出を把握し、節約意識を向上させる
- インストール不要で、ブラウザだけで動作する手軽さ

### 2.2 対象ユーザー
- 家計簿を付けたいが、複雑なアプリは使いたくない方
- シンプルに支出を記録したい方
- データをクラウドではなくローカルで管理したい方

## 3. 画面構成

### 3.1 全体レイアウト

```
┌─────────────────────────────────────┐
│         💰 支出管理アプリ            │  ← ヘッダー
├─────────────────────────────────────┤
│  【支出を記録】                      │
│  ┌───────────────────────────────┐  │
│  │ 日付: [2025-11-29      ▼]    │  │
│  │ カテゴリ: [選択してください▼] │  │
│  │ 金額: [________] 円           │  │
│  │ メモ: [________________]      │  │
│  │        [記録する]              │  │
│  └───────────────────────────────┘  │
├─────────────────────────────────────┤
│  【カテゴリ別集計】                  │
│  ┌────────┬────────┬────────┐      │
│  │ 食費   │交通費  │娯楽費  │      │
│  │ ¥8,500 │¥3,200  │¥5,000  │      │
│  └────────┴────────┴────────┘      │
│  合計: ¥16,700 円                   │
├─────────────────────────────────────┤
│  【支出一覧】                        │
│  [スプレッドシートと同期]            │
│  ┌───────────────────────────────┐  │
│  │ 2025/11/29 (金)              │  │
│  │ [食費] ランチ                 │  │
│  │ ¥800              [削除]     │  │
│  ├───────────────────────────────┤  │
│  │ 2025/11/28 (木)              │  │
│  │ [交通費] 電車代               │  │
│  │ ¥320              [削除]     │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

### 3.2 画面セクション

1. **ヘッダー**: アプリタイトル表示
2. **入力セクション**: 支出情報の入力フォーム
3. **集計セクション**: カテゴリ別の集計表示
4. **一覧セクション**: 記録済み支出の一覧表示

## 4. 入出力仕様

### 4.1 入力仕様

| 項目名 | 入力形式 | 必須 | 制約 | 初期値 | 備考 |
|--------|----------|------|------|--------|------|
| 日付 | date型input | ◯ | - | 当日日付 | カレンダーピッカーで選択 |
| カテゴリ | select（プルダウン） | ◯ | 7種類から選択 | 未選択 | 選択肢は後述 |
| 金額 | number型input | ◯ | 0以上の整数 | - | 単位は「円」 |
| メモ | text型input | - | 最大100文字推奨 | - | 支出の詳細を記入 |

### 4.2 カテゴリ選択肢（プルダウン）

```html
<select id="category" required>
  <option value="">選択してください</option>
  <option value="食費">食費</option>
  <option value="交通費">交通費</option>
  <option value="娯楽費">娯楽費</option>
  <option value="日用品">日用品</option>
  <option value="医療費">医療費</option>
  <option value="光熱費">光熱費</option>
  <option value="その他">その他</option>
</select>
```

### 4.3 出力仕様

#### 4.3.1 カテゴリ別集計
- カテゴリごとの合計金額を表示
- 金額の大きい順に並び替え
- 全カテゴリの合計金額を表示

#### 4.3.2 支出一覧
- 日付の新しい順に表示
- 各支出に削除ボタンを配置
- 日付、カテゴリ、金額、メモを表示

## 5. 機能一覧

### 5.1 支出記録機能

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F001 | 支出入力 | 日付、カテゴリ、金額、メモを入力 | 高 |
| F002 | 入力検証 | 必須項目チェック（日付、カテゴリ、金額） | 高 |
| F003 | データ保存 | localStorageに自動保存 | 高 |
| F004 | フォームリセット | 保存後、フォームを初期状態に戻す | 中 |
| F005 | 成功通知 | 保存成功時に通知メッセージ表示 | 低 |

### 5.2 支出一覧表示機能

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F011 | 一覧表示 | 保存済み支出を日付降順で表示 | 高 |
| F012 | 削除機能 | 個別の支出を削除（確認ダイアログ付き） | 高 |
| F013 | 空状態表示 | データがない場合のメッセージ表示 | 中 |
| F014 | 日付フォーマット | 「YYYY/MM/DD (曜日)」形式で表示 | 中 |

### 5.3 カテゴリ別集計機能

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F021 | カテゴリ別集計 | カテゴリごとの合計金額を計算 | 高 |
| F022 | 合計金額表示 | 全支出の合計金額を表示 | 高 |
| F023 | 金額ソート | 金額の大きい順に表示 | 中 |
| F024 | カンマ区切り | 金額を3桁区切りで表示（¥1,000） | 中 |

### 5.4 データ永続化機能

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F031 | localStorage保存 | 支出データをブラウザに保存 | 高 |
| F032 | 自動読み込み | ページ読み込み時に自動でデータ取得 | 高 |
| F033 | データ同期 | 追加・削除時にリアルタイム更新 | 高 |

### 5.5 外部連携機能（オプション）

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F041 | Spreadsheet同期 | Google Spreadsheetにデータバックアップ | 低 |
| F042 | 重複防止 | 同じIDのデータは重複登録しない | 低 |

## 6. 使用技術

### 6.1 技術スタック

| 技術 | バージョン | 用途 |
|------|-----------|------|
| HTML5 | - | ページ構造の定義 |
| CSS3 | - | デザイン・レイアウト |
| JavaScript (ES6+) | - | 機能実装・データ処理 |
| localStorage API | - | データ永続化 |

### 6.2 HTML

#### 6.2.1 使用するHTML要素
- `<form>`: 支出入力フォーム
- `<input type="date">`: 日付入力
- `<select>`: カテゴリ選択（プルダウン）
- `<input type="number">`: 金額入力
- `<input type="text">`: メモ入力
- `<button>`: 記録ボタン、削除ボタン
- `<div>`: セクション区切り、カード表示

#### 6.2.2 セマンティックHTML
```html
<section class="input-section">   <!-- 入力セクション -->
<section class="summary-section">  <!-- 集計セクション -->
<section class="list-section">     <!-- 一覧セクション -->
```

### 6.3 CSS

#### 6.3.1 デザインコンセプト
- モダンでクリーンなデザイン
- グラデーション背景
- カード型レイアウト
- レスポンシブ対応（モバイル・タブレット・PC）

#### 6.3.2 主要スタイル
- **カラーパレット**
  - プライマリ: `#667eea` (紫)
  - セカンダリ: `#48bb78` (緑)
  - 削除: `#f56565` (赤)
  - 背景グラデーション: `#667eea` → `#764ba2`

- **レイアウト**
  - Grid Layout: カテゴリ別集計
  - Flexbox: 支出一覧の各アイテム
  - 最大幅: 900px（中央寄せ）

#### 6.3.3 レスポンシブ対応
```css
@media (max-width: 768px) {
  /* スマートフォン向けレイアウト */
}
```

### 6.4 JavaScript

#### 6.4.1 主要関数

| 関数名 | 用途 | 引数 | 戻り値 |
|--------|------|------|--------|
| `loadExpenses()` | localStorageからデータ読み込み | なし | Array |
| `saveExpenses(expenses)` | localStorageにデータ保存 | expenses: Array | void |
| `handleAddExpense(e)` | 支出追加処理 | e: Event | void |
| `deleteExpense(id)` | 支出削除処理 | id: Number | void |
| `renderExpenseList()` | 一覧表示更新 | なし | void |
| `renderCategorySummary()` | 集計表示更新 | なし | void |
| `formatDate(dateString)` | 日付フォーマット | dateString: String | String |
| `showNotification(message)` | 通知表示 | message: String | void |

#### 6.4.2 イベント処理
- フォーム送信: `submit`イベント
- 削除ボタン: `onclick`イベント（動的生成）
- ページ読み込み: `DOMContentLoaded`イベント

## 7. データ構造（localStorage利用）

### 7.1 ストレージキー

```javascript
const STORAGE_KEY = 'expenses';
```

### 7.2 データ形式（オブジェクト配列）

#### 7.2.1 全体構造
```javascript
// localStorageに保存される形式（JSON文字列化）
localStorage.setItem('expenses', JSON.stringify(expensesArray));
```

#### 7.2.2 配列形式
```javascript
[
  {
    id: 1732838400000,
    date: "2025-11-29",
    category: "食費",
    amount: 800,
    memo: "ランチ"
  },
  {
    id: 1732752000000,
    date: "2025-11-28",
    category: "交通費",
    amount: 320,
    memo: "電車代"
  },
  {
    id: 1732665600000,
    date: "2025-11-27",
    category: "娯楽費",
    amount: 2500,
    memo: "映画鑑賞"
  }
]
```

### 7.3 フィールド定義

| フィールド名 | データ型 | 必須 | 説明 | 例 |
|-------------|---------|------|------|-----|
| `id` | Number | ◯ | ユニークID（タイムスタンプ） | `1732838400000` |
| `date` | String | ◯ | 支出日（ISO 8601形式） | `"2025-11-29"` |
| `category` | String | ◯ | カテゴリ名 | `"食費"` |
| `amount` | Number | ◯ | 金額（整数） | `800` |
| `memo` | String | - | メモ（空文字可） | `"ランチ"` |

### 7.4 データ操作

#### 7.4.1 読み込み
```javascript
function loadExpenses() {
  const data = localStorage.getItem(STORAGE_KEY);
  return data ? JSON.parse(data) : [];
}
```

#### 7.4.2 保存
```javascript
function saveExpenses(expenses) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(expenses));
}
```

#### 7.4.3 追加
```javascript
const expense = {
  id: Date.now(),  // 現在時刻のタイムスタンプ
  date: "2025-11-29",
  category: "食費",
  amount: 800,
  memo: "ランチ"
};

const expenses = loadExpenses();
expenses.push(expense);
saveExpenses(expenses);
```

#### 7.4.4 削除
```javascript
function deleteExpense(id) {
  let expenses = loadExpenses();
  expenses = expenses.filter(expense => expense.id !== id);
  saveExpenses(expenses);
}
```

### 7.5 データサンプル

#### 7.5.1 初期状態（空）
```json
[]
```

#### 7.5.2 データ登録後
```json
[
  {
    "id": 1732838400000,
    "date": "2025-11-29",
    "category": "食費",
    "amount": 1200,
    "memo": "スーパーで買い物"
  },
  {
    "id": 1732838460000,
    "date": "2025-11-29",
    "category": "交通費",
    "amount": 320,
    "memo": "電車代（往復）"
  },
  {
    "id": 1732752000000,
    "date": "2025-11-28",
    "category": "娯楽費",
    "amount": 2500,
    "memo": "映画鑑賞"
  },
  {
    "id": 1732752100000,
    "date": "2025-11-28",
    "category": "食費",
    "amount": 800,
    "memo": "ランチ"
  },
  {
    "id": 1732665600000,
    "date": "2025-11-27",
    "category": "日用品",
    "amount": 1500,
    "memo": "洗剤、ティッシュ"
  }
]
```

### 7.6 データ容量制限

- **localStorage制限**: 約5MB（ブラウザにより異なる）
- **推定データ量**: 1件あたり約100バイト
- **登録可能件数**: 約50,000件（実用上は数千件で十分）

### 7.7 データバックアップ

#### 7.7.1 ローカルバックアップ
- ブラウザのlocalStorageに自動保存
- ブラウザのキャッシュクリアで削除される可能性あり

#### 7.7.2 外部バックアップ（オプション）
- Google Spreadsheet連携機能を使用
- 定期的に「同期」ボタンでバックアップ推奨

## 8. 非機能要件

### 8.1 パフォーマンス
- ページ読み込み時間: 1秒以内
- データ保存処理: 0.1秒以内
- UI応答性: 即座（遅延なし）

### 8.2 ブラウザ対応
- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）

### 8.3 セキュリティ
- データはブラウザ内のみに保存（外部送信なし）※Spreadsheet同期除く
- XSS対策: `textContent`を使用してHTML注入を防止

### 8.4 ユーザビリティ
- 直感的なUI設計
- エラー時の分かりやすいメッセージ
- 削除前の確認ダイアログ

## 9. 今後の拡張案

| 優先度 | 機能 | 説明 |
|--------|------|------|
| 高 | 月別集計 | 月ごとの支出をグラフ表示 |
| 高 | 検索・フィルター | カテゴリや日付で絞り込み |
| 中 | 予算設定 | 月間予算の設定と達成率表示 |
| 中 | CSVエクスポート | データをCSVファイルで出力 |
| 低 | PWA対応 | オフラインでも動作するように |
| 低 | ダークモード | 夜間使用時に目に優しいモード |

## 10. 開発スケジュール（参考）

1. **Phase 1**: HTML/CSS実装（基本デザイン）
2. **Phase 2**: JavaScript実装（localStorage基本機能）
3. **Phase 3**: 集計・表示機能実装
4. **Phase 4**: テスト・バグフィックス
5. **Phase 5**: Spreadsheet連携（オプション）
6. **Phase 6**: デプロイ（GitHub Pages）

---

**作成日**: 2025-11-29
**バージョン**: 1.0
**作成者**: 支出管理アプリ開発チーム
